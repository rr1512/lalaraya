import{v as k,e as b,j as e,f,T as n,L as S,aM as w,q as B,b as _,g as I,s as M,a as H,w as $,r as g,a6 as R,d as u,K as z,z as V,B as j,t as y,P as W,a4 as G,h as A,F as Q,n as d,D as J,k as O,l as X}from"./main-eb4aecd5.js";import{i as h,e as E,l as C,u as Y,c as Z,b as ee,F as q,T as se,m as ae,n as v,o as te,p as P}from"./blank-page-skeleton-3a415e55.js";import{a as ne}from"./DesktopMac-429b993b.js";import{I as re}from"./info-dialog-trigger-abf9443a.js";const ie=""+new URL("publish-f1b40831.svg",import.meta.url).href;function oe(s){return k({queryKey:["custom-domain",s],queryFn:()=>le(s)})}function le(s){return b.get("custom-domain",{params:s}).then(a=>a.data)}function ce({resourceName:s,className:a,size:t="md",color:r="bgAlt",reason:i="overQuota",...c}){const l=c.message??e.jsx(me,{resourceName:s,reason:i});return e.jsx(h,{color:r,size:t,className:a,description:l})}function me({resourceName:s,reason:a}){const{billing:t}=f();if(a==="noWorkspacePermission")return e.jsx(n,{message:"You can't create new :name in this workspace.",values:{name:s}});const r={name:s,a:i=>e.jsx(S,{className:w,to:"/pricing",children:i})};return a==="overQuota"&&t.enable?e.jsx(n,{message:"Your plan is at its maximum number of :name allowed. <a>Upgrade to add more.</a>",values:r}):a==="noPermission"&&t.enable?e.jsx(n,{message:"To unlock ability to create :name. <a>Upgrade your plan.</a>",values:r}):e.jsx(n,{message:"You don't have permissions to create :name."})}function de(s,a){return k({queryKey:["projects",`${s}`],queryFn:()=>ue(s),initialData:()=>({project:a})})}function K(s){return B.invalidateQueries({queryKey:["projects",`${s}`]})}function ue(s){return b.get(`projects/${s}`).then(a=>a.data)}function F(s,a){return _({mutationFn:t=>xe(s,t),onSuccess:()=>K(s),onError:t=>a?I(t,a):M(t)})}async function xe(s,a){return b.post(`projects/${s}/settings`,a).then(t=>t.data)}function je({project:s}){const{builder:a}=f();return e.jsxs("div",{className:"mb-8 mt-18",children:[e.jsx(N,{title:e.jsx(n,{message:"Preview url"}),children:e.jsx(L,{href:E(s),children:E(s,{removeProtocol:!0})})}),(a==null?void 0:a.enable_subdomains)&&e.jsx(N,{className:"mt-8 border-t pt-8",title:e.jsx(n,{message:"Free subdomain"}),children:e.jsx(L,{href:C(s),children:C(s,{removeProtocol:!0})})}),(a==null?void 0:a.enable_custom_domains)&&e.jsx(he,{project:s})]})}function he({project:s}){var T;const{trans:a}=H(),{user:t}=$(),r=F(s.id),{data:i,isLoading:c}=oe({userId:t.id}),l=(i==null?void 0:i.pagination.data)||[],{data:m}=Y(),p=o=>{var D;o!==((D=s.domain)==null?void 0:D.id)&&r.mutate({domainId:o},{onSuccess:()=>y(u("Domain changed"))})};let x=null;return!i&&c?x=e.jsx(W,{size:"sm",isIndeterminate:!0}):x=e.jsxs(g.Fragment,{children:[!!l.length&&e.jsxs(R,{selectionMode:"single",size:"sm",className:"mb-14",placeholder:a(u("Select a domain...")),disabled:r.isPending,selectedValue:((T=s.domain)==null?void 0:T.id)??null,onItemSelected:o=>{p(o)},children:[e.jsx(z,{value:null,children:e.jsx(n,{message:"No custom domain"})}),l.map(o=>e.jsx(z,{value:o.id,children:Z(o.host)},o.id))]}),(m==null?void 0:m.custom_domains.create.allowed)===!1?e.jsx(ce,{size:"sm",resourceName:e.jsx(n,{message:"custom domains"})}):e.jsxs(V,{type:"modal",children:[e.jsx(j,{variant:"outline",color:"primary",size:"xs",children:e.jsx(n,{message:"Connect domain"})}),e.jsx(ee,{})]})]}),e.jsx(N,{className:"mt-8 border-t pt-8",title:e.jsx(n,{message:"Branded domain"}),description:e.jsx(n,{message:"Select your own custom domain at which this site should be accessible."}),children:e.jsx("div",{className:"mt-10",children:x})})}function N({title:s,description:a,children:t,className:r}){return e.jsxs("div",{className:r,children:[e.jsx("div",{className:"mb-2 text-sm font-medium",children:s}),!!a&&e.jsx("div",{className:"text-xs text-muted",children:a}),t]})}function L({href:s,children:a}){return e.jsx("a",{href:s,target:"_blank",className:"text-xs text-primary hover:underline",rel:"noreferrer",children:a})}function pe({project:s}){return e.jsxs("div",{children:[e.jsx(h,{className:"mb-18",description:e.jsx(n,{message:"All the ways your site can be viewed online. You can prevent this site from being accessible online by unpublishing it below."}),color:"neutral"}),e.jsx(ge,{project:s}),e.jsx(je,{project:s})]})}function ge({project:s}){const a=F(s.id),{hasPermission:t}=$();return e.jsxs("div",{className:"flex items-center gap-24 rounded-panel border border-primary-light/30 bg-primary-light/10 p-14",children:[e.jsx(G,{src:ie,className:"max-w-90"}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-8",children:s.published?e.jsx(n,{message:"Your site is published"}):e.jsx(n,{message:"Your site is not published"})}),e.jsx(j,{variant:"outline",color:"primary",size:"xs",disabled:a.isPending||!s.published&&!t("projects.publish"),onClick:()=>a.mutate({published:!s.published},{onSuccess:r=>{y(r.project.published?u("Project published"):u("Project unpublished"))}}),children:s.published?e.jsx(n,{message:"Unpublish"}):e.jsx(n,{message:"Publish"})})]})]})}function be({project:s}){var r;const a=A({defaultValues:{formsEmail:(r=s.settings)==null?void 0:r.formsEmail}}),t=F(s.id,a);return e.jsxs("div",{className:"mb-8",children:[e.jsx(h,{className:"mb-18",description:e.jsx(n,{message:"When a form is submitted on your published site, submitted data will be collected and sent to this email address."}),color:"neutral"}),e.jsxs(Q,{form:a,onSubmit:i=>{t.mutate(i,{onSuccess:()=>y(u("Forms email updated"))})},children:[e.jsx(d,{name:"formsEmail",type:"email",label:e.jsx(n,{message:"Send form submissions to"}),description:e.jsx(n,{message:"If left empty, will default to your account's primary email address."})}),e.jsx("div",{className:"mt-14",children:e.jsx(j,{variant:"flat",color:"primary",type:"submit",disabled:t.isPending||!a.formState.isDirty,children:e.jsx(n,{message:"Save"})})})]})]})}function fe(s,a){return _({mutationFn:t=>ye(s,t),onSuccess:()=>K(s),onError:t=>a?I(t,a):M(t)})}async function ye(s,a){return b.post(`projects/${s}/export/ftp`,a).then(t=>t.data)}function ve({project:s}){const{base_url:a}=f(),{data:t}=Y();return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-14 border-b pb-20",children:[e.jsx(U,{children:e.jsx(n,{message:"Export your site as a zip file"})}),(t==null?void 0:t.projects.download)===!1&&e.jsx(Ne,{}),e.jsx(j,{variant:"outline",size:"xs",elementType:"a",download:!0,color:"primary",href:`${a}/api/v1/projects/${s.id}/download`,startIcon:e.jsx(ne,{}),disabled:!(t!=null&&t.projects.download),children:e.jsx(n,{message:"Download zip file"})})]}),e.jsxs("div",{children:[e.jsx(U,{children:e.jsx(n,{message:"Export to your own FTP server"})}),(t==null?void 0:t.projects.export)===!1&&e.jsx(Se,{}),e.jsx(Pe,{project:s,disabled:!(t!=null&&t.projects.export)})]})]})}function U({children:s}){return e.jsx("div",{className:"mb-10 text-sm font-semibold",children:s})}function Pe({project:s,disabled:a}){var m,p;const{publish:t}=f(),r=(t==null?void 0:t.allow_credential_change)??!1,i=(p=(m=s.settings)==null?void 0:m.ftpCredentials)!=null&&p.host?{...s.settings.ftpCredentials}:{...t==null?void 0:t.default_credentials};i.directory||(i.directory=s.slug);const c=A({defaultValues:i}),l=fe(s.id,c);return e.jsxs(Q,{form:c,onSubmit:x=>{l.mutate(x,{onSuccess:()=>{y(u("Project exported"))}})},children:[r&&e.jsxs(g.Fragment,{children:[e.jsx(d,{name:"host",label:e.jsx(n,{message:"Host"}),required:!0,size:"sm",className:"mb-14"}),e.jsxs("div",{className:"mb-14 flex gap-10",children:[e.jsx(d,{name:"username",label:e.jsx(n,{message:"Username"}),required:!0,size:"sm",className:"flex-1"}),e.jsx(d,{name:"password",type:"password",label:e.jsx(n,{message:"Password"}),required:!0,size:"sm",className:"flex-1"})]}),e.jsxs("div",{className:"mb-14 flex gap-10",children:[e.jsx(d,{name:"directory",label:e.jsxs(g.Fragment,{children:[e.jsx(n,{message:"Directory"}),e.jsx(re,{body:e.jsx(n,{message:"In which directory on your FTP server should site files be stored. Leave empty to store at root."})})]}),size:"sm",className:"flex-1"}),e.jsx(d,{name:"port",type:"number",min:1,label:e.jsx("div",{className:"min-h-24",children:e.jsx(n,{message:"Port"})}),placeholder:"21",className:"flex-1",size:"sm"})]}),e.jsx(q,{name:"ssl",className:"mb-10",children:e.jsx(n,{message:"Use SSL"})}),e.jsx(q,{name:"rememberCredentials",children:e.jsx(n,{message:"Remember credentials"})})]}),e.jsx("div",{className:"mt-28",children:e.jsx(j,{variant:"flat",color:"primary",type:"submit",disabled:a||l.isPending,children:e.jsx(n,{message:"Export"})})})]})}function Ne(){return e.jsx(h,{className:"mb-14",color:"bgAlt",size:"sm",description:e.jsx(n,{message:"To download your site as a zip file <a>upgrade your plan.</a>",values:{a:s=>e.jsx(S,{className:w,to:"/pricing",children:s})}})})}function Se(){return e.jsx(h,{className:"mb-14",color:"bgAlt",size:"sm",description:e.jsx(n,{message:"To export your site via FTP or as a .zip file <a>upgrade your plan.</a>",values:{a:s=>e.jsx(S,{className:w,to:"/pricing",children:s})}})})}function ze({project:s}){const{data:a}=de(s.id,s),[t,r]=g.useState(0);return e.jsxs(J,{size:"lg",children:[e.jsx(O,{children:e.jsx(n,{message:"Project settings"})}),e.jsx(X,{children:e.jsxs(se,{selectedTab:t,onTabChange:r,children:[e.jsxs(ae,{children:[e.jsx(v,{children:e.jsx(n,{message:"Publishing"})}),e.jsx(v,{children:e.jsx(n,{message:"Forms"})}),e.jsx(v,{children:e.jsx(n,{message:"Export"})})]}),e.jsxs(te,{className:"pt-14",children:[e.jsx(P,{children:e.jsx(pe,{project:a.project})}),e.jsx(P,{children:e.jsx(be,{project:a.project})}),e.jsx(P,{children:e.jsx(ve,{project:a.project})})]})]})})]})}export{ce as P,ze as a,oe as u};
//# sourceMappingURL=project-settings-dialog-c3ce13d7.js.map
